<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with wqbc • wqbc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with wqbc">
<meta property="og:description" content="wqbc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wqbc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/wqbc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bcgov/wqbc/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="wqbc_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with wqbc</h1>
            
            <h4 class="date">2020-07-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/wqbc/blob/master/vignettes/wqbc.Rmd"><code>vignettes/wqbc.Rmd</code></a></small>
      <div class="hidden name"><code>wqbc.Rmd</code></div>

    </div>

    
    
<p>The <code>wqbc</code> R package calculates water quality limits for British Columbia.</p>
<p>Previously it also calculated the <a href="http://www.ccme.ca/en/resources/canadian_environmental_quality_guidelines/index.html">CCME Water Quality Index</a> but that functionality has been moved to the <a href="https://github.com/bcgov/wqindex">wqindex</a> package.</p>
<div id="fraser-data" class="section level2">
<h2 class="hasAnchor">
<a href="#fraser-data" class="anchor"></a>Fraser Data</h2>
<p>The data used in this demonstration are from the Fraser River basin (data available <a href="http://data.gc.ca/data/en/dataset/9ec91c92-22f8-4520-8b2c-0f1cce663e18">here</a> under the <a href="http://open.canada.ca/en/open-government-licence-canada">Candian Open Government License</a>.</p>
<p>To load the <code>wqbc</code> package and the <code>fraser</code> data run</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/bcgov/wqbc">wqbc</a></span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="kw">fraser</span>)
</pre></div>
<p>The <code>fraser</code> data is organized so that each row corresponds to one observation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://tibble.tidyverse.org">tibble</a></span>) <span class="co"># for prettier printing of tibbles</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw">fraser</span>)
<span class="co">#&gt; # A tibble: 242,631 x 8</span>
<span class="co">#&gt;    SiteID    Date       Variable          Value Units Site             Lat  Long</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;date&gt;     &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 BC08KA00… 2000-01-12 ALKALINITY TOT… 59.1    MG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  2 BC08KA00… 2000-01-12 ALUMINUM TOTAL   0.061  MG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  3 BC08KA00… 2000-01-12 BARIUM EXTRACT… 14.5    UG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  4 BC08KA00… 2000-01-12 BARIUM TOTAL     0.0141 MG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  5 BC08KA00… 2000-01-12 BERYLLIUM EXTR…  0      UG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  6 BC08KA00… 2000-01-12 BERYLLIUM TOTAL  0      UG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  7 BC08KA00… 2000-01-12 BORON EXTRACTA…  0.77   UG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  8 BC08KA00… 2000-01-12 CADMIUM EXTRAC…  0.007  UG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt;  9 BC08KA00… 2000-01-12 CADMIUM TOTAL    0      MG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt; 10 BC08KA00… 2000-01-12 CALCIUM EXTRAC… 19.7    MG/L  FRASER RIVER …  53.0 -119.</span>
<span class="co">#&gt; # … with 242,621 more rows</span>
</pre></div>
<p>As the <code>fraser</code> data is a large dataset (242631 rows) we’ll just use the data from 2012.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">data2012</span> <span class="op">&lt;-</span> <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">fraser</span>, <span class="kw">lubridate</span>::<span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="kw">Date</span>) <span class="op">==</span> <span class="fl">2012</span>)
<span class="kw">data2012</span>
<span class="co">#&gt; # A tibble: 17,881 x 8</span>
<span class="co">#&gt;    SiteID    Date       Variable         Value Units Site              Lat  Long</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;date&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 BC08KA00… 2012-01-24 ALKALINITY TOT… 64.1   MG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  2 BC08KA00… 2012-01-24 ALUMINUM TOTAL  42     UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  3 BC08KA00… 2012-01-24 ANTIMONY TOTAL   0.009 UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  4 BC08KA00… 2012-01-24 ARSENIC TOTAL    0.12  UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  5 BC08KA00… 2012-01-24 BARIUM TOTAL    15     UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  6 BC08KA00… 2012-01-24 BERYLLIUM TOTAL  0     UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  7 BC08KA00… 2012-01-24 BISMUTH TOTAL    0     UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  8 BC08KA00… 2012-01-24 BORON TOTAL      1.6   UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt;  9 BC08KA00… 2012-01-24 CADMIUM TOTAL    0.003 UG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt; 10 BC08KA00… 2012-01-24 CALCIUM DISSOL… 20     MG/L  FRASER RIVER A…  53.0 -119.</span>
<span class="co">#&gt; # … with 17,871 more rows</span>
</pre></div>
<p>This leaves us with a dataset with 17881 rows. Before the data can be assigned the water quality limits provided by <code>wqbc</code> they first have to be standardized and then cleaned.</p>
<div id="standardizing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#standardizing-data" class="anchor"></a>Standardizing Data</h3>
<p>The <code><a href="../reference/standardize_wqdata.html">standardize_wqdata()</a></code> function converts any non-standard variable names, checks (and if possible) converts the units and removes any missing and negative values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">data2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_wqdata.html">standardize_wqdata</a></span>(<span class="kw">data2012</span>)
<span class="co">#&gt; Standardizing water quality data...</span>
<span class="co">#&gt; Deleted 43 rows with negative values in Value.</span>
<span class="co">#&gt; Substituted 'ALKALINITY TOTAL CACO3' with 'Alkalinity Total', 'ALUMINUM DISSOLVED' with 'Aluminum Dissolved', 'AMMONIA DISSOLVED' with 'Ammonia Dissolved', 'ARSENIC DISSOLVED' with 'Arsenic Dissolved', 'ARSENIC TOTAL' with 'Arsenic Total', 'BARIUM DISSOLVED' with 'Barium Dissolved', 'BARIUM TOTAL' with 'Barium Total', 'BERYLLIUM TOTAL' with 'Beryllium Total', 'BORON DISSOLVED' with 'Boron Dissolved', 'BORON TOTAL' with 'Boron Total', 'CADMIUM DISSOLVED' with 'Cadmium Dissolved', 'CADMIUM TOTAL' with 'Cadmium Total', 'CHLORIDE DISSOLVED' with 'Chloride Dissolved', 'CHROMIUM DISSOLVED' with 'Chromium Dissolved', 'CHROMIUM TOTAL' with 'Chromium Total', 'COBALT DISSOLVED' with 'Cobalt Dissolved', 'COBALT TOTAL' with 'Cobalt Total', 'COLOUR TRUE' with 'Colour True', 'COPPER DISSOLVED' with 'Copper Dissolved', 'COPPER TOTAL' with 'Copper Total', 'FIELD PH' with 'pH', 'FLUORIDE DISSOLVED' with 'Fluoride Dissolved', 'HARDNESS TOTAL (CALCD.) CACO3' with 'Hardness Total', 'IRON DISSOLVED' with 'Iron Dissolved', 'IRON TOTAL' with 'Iron Total', 'LEAD DISSOLVED' with 'Lead Dissolved', 'LEAD TOTAL' with 'Lead Total', 'MANGANESE DISSOLVED' with 'Manganese Dissolved', 'MANGANESE TOTAL' with 'Manganese Total', 'MOLYBDENUM DISSOLVED' with 'Molybdenum Dissolved', 'MOLYBDENUM TOTAL' with 'Molybdenum Total', 'NICKEL DISSOLVED' with 'Nickel Dissolved', 'NICKEL TOTAL' with 'Nickel Total', 'NITROGEN DISSOLVED KJELDAHL' with 'Nitrogen Dissolved', 'NITROGEN DISSOLVED NO3 &amp; NO2' with 'Nitrogen Dissolved', 'NITROGEN TOTAL' with 'Nitrogen Total', 'NITROGEN TOTAL DISSOLVED' with 'Nitrogen Dissolved', 'NITROGEN TOTAL KJELDAHL' with 'Nitrogen Total', 'OXYGEN DISSOLVED' with 'Oxygen Dissolved', 'PH' with 'pH', 'PHOSPHORUS TOTAL' with 'Phosphorus Total', 'PHOSPHORUS TOTAL DISSOLVED' with 'Phosphorus Dissolved', 'SELENIUM DISSOLVED' with 'Selenium Dissolved', 'SELENIUM TOTAL' with 'Selenium Total', 'SILVER DISSOLVED' with 'Silver Dissolved', 'SILVER TOTAL' with 'Silver Total', 'SULPHATE DISSOLVED' with 'Sulphate Dissolved', 'TEMPERATURE AIR' with 'Temperature', 'TEMPERATURE WATER' with 'Temperature', 'THALLIUM DISSOLVED' with 'Thallium Dissolved', 'THALLIUM TOTAL' with 'Thallium Total', 'TURBIDITY' with 'Turbidity', 'URANIUM DISSOLVED' with 'Uranium Dissolved', 'URANIUM TOTAL' with 'Uranium Total', 'ZINC DISSOLVED' with 'Zinc Dissolved' and 'ZINC TOTAL' with 'Zinc Total'.</span>
<span class="co">#&gt; Failed to substitute 'ALKALINITY GRAN CACO3', 'ALUMINUM TOTAL', 'ANTIMONY DISSOLVED', 'ANTIMONY TOTAL', 'BERYLLIUM DISSOLVED', 'BISMUTH DISSOLVED', 'BISMUTH TOTAL', 'CALCIUM DISSOLVED', 'CARBON DISSOLVED INORGANIC', 'CARBON DISSOLVED ORGANIC', 'CARBON TOTAL ORGANIC', 'CERIUM DISSOLVED', 'CERIUM TOTAL', 'CESIUM DISSOLVED', 'CESIUM TOTAL', 'GALLIUM TOTAL', 'LANTHANUM DISSOLVED', 'LANTHANUM TOTAL', 'LITHIUM DISSOLVED', 'LITHIUM TOTAL', 'MAGNESIUM DISSOLVED', 'NIOBIUM DISSOLVED', 'NIOBIUM TOTAL', 'NITROGEN DISSOLVED NITRATE', 'NITROGEN NITRITE', 'PLATINUM DISSOLVED', 'PLATINUM TOTAL', 'POTASSIUM DISSOLVED', 'RESIDUE FILTERABLE', 'RESIDUE NONFILTRABLE', 'RUBIDIUM DISSOLVED', 'RUBIDIUM TOTAL', 'SALINITY', 'SODIUM DISSOLVED', 'SPECIFIC CONDUCTANCE', 'SPECIFIC CONDUCTANCE - FIELD', 'STRONTIUM DISSOLVED', 'STRONTIUM TOTAL', 'TIN DISSOLVED', 'TIN TOTAL', 'TUNGSTEN DISSOLVED', 'TUNGSTEN TOTAL', 'VANADIUM DISSOLVED', 'VANADIUM TOTAL' and 'YTTRIUM TOTAL'.</span>
<span class="co">#&gt; Deleted 7584 rows with missing values in Variable.</span>
<span class="co">#&gt; Substituted 'DEG C' with 'degC', 'MG/L' with 'mg/L', 'PH UNITS' with 'pH' and 'UG/L' with 'ug/L'.</span>
<span class="co">#&gt; Failed to substitute 'COLOR UNIT'.</span>
<span class="co">#&gt; Deleted 271 rows with missing values in Units.</span>
<span class="co">#&gt; Standardized water quality data.</span>
</pre></div>
<p>As a result of the standardization, the 2012 Fraser dataset has been reduced to 9983 observations that can in principle be assigned water quality limits by the <code>wqbc</code> package. However, first it is necessary to deal with multiple observations by cleaning the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">data2012</span>)
<span class="co">#&gt; # A tibble: 9,983 x 8</span>
<span class="co">#&gt;    SiteID    Date       Variable       Value Units Site                Lat  Long</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;date&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 BC08KA00… 2012-01-24 Alkalinity To…  64.1 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  2 BC08KA00… 2012-04-11 Alkalinity To…  65.1 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  3 BC08KA00… 2012-04-18 Alkalinity To…  63.5 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  4 BC08KA00… 2012-05-01 Alkalinity To…  59.5 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  5 BC08KA00… 2012-05-16 Alkalinity To…  59.5 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  6 BC08KA00… 2012-05-30 Alkalinity To…  58.8 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  7 BC08KA00… 2012-06-11 Alkalinity To…  56.5 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  8 BC08KA00… 2012-07-10 Alkalinity To…  43.2 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt;  9 BC08KA00… 2012-07-16 Alkalinity To…  40.8 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt; 10 BC08KA00… 2012-07-25 Alkalinity To…  40.9 mg/L  FRASER RIVER AT …  53.0 -119.</span>
<span class="co">#&gt; # … with 9,973 more rows</span>
</pre></div>
</div>
<div id="cleaning-data" class="section level3">
<h3 class="hasAnchor">
<a href="#cleaning-data" class="anchor"></a>Cleaning Data</h3>
<p>After standardization, it is necessary to ensure that there are only single values for each date for a given variable and this is done using the function <code><a href="../reference/clean_wqdata.html">clean_wqdata()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">data2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_wqdata.html">clean_wqdata</a></span>(<span class="kw">data2012</span>, by = <span class="st">"SiteID"</span>)
<span class="co">#&gt; Cleaning water quality data...</span>
<span class="co">#&gt; Identified 0 outliers in water quality data.</span>
<span class="co">#&gt; Cleansed water quality data.</span>
</pre></div>
<p>The end result is a data frame with 8950 rows each of which represents the average value for a single variable on a particular date at an individual <code>SiteID</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">data2012</span>)
<span class="co">#&gt; # A tibble: 8,950 x 7</span>
<span class="co">#&gt;    SiteID     Date       Variable         Value Units Outlier DetectionLimit</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;date&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt; &lt;lgl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 BC08KA0007 2012-01-24 Alkalinity Total  64.1 mg/L  FALSE               NA</span>
<span class="co">#&gt;  2 BC08KA0007 2012-04-11 Alkalinity Total  65.1 mg/L  FALSE               NA</span>
<span class="co">#&gt;  3 BC08KA0007 2012-04-18 Alkalinity Total  63.5 mg/L  FALSE               NA</span>
<span class="co">#&gt;  4 BC08KA0007 2012-05-01 Alkalinity Total  59.5 mg/L  FALSE               NA</span>
<span class="co">#&gt;  5 BC08KA0007 2012-05-16 Alkalinity Total  59.5 mg/L  FALSE               NA</span>
<span class="co">#&gt;  6 BC08KA0007 2012-05-30 Alkalinity Total  58.8 mg/L  FALSE               NA</span>
<span class="co">#&gt;  7 BC08KA0007 2012-06-11 Alkalinity Total  56.5 mg/L  FALSE               NA</span>
<span class="co">#&gt;  8 BC08KA0007 2012-07-10 Alkalinity Total  43.2 mg/L  FALSE               NA</span>
<span class="co">#&gt;  9 BC08KA0007 2012-07-16 Alkalinity Total  40.8 mg/L  FALSE               NA</span>
<span class="co">#&gt; 10 BC08KA0007 2012-07-25 Alkalinity Total  40.9 mg/L  FALSE               NA</span>
<span class="co">#&gt; # … with 8,940 more rows</span>
</pre></div>
</div>
<div id="calculating-limits" class="section level3">
<h3 class="hasAnchor">
<a href="#calculating-limits" class="anchor"></a>Calculating Limits</h3>
<p>Once the data have been standardized and cleansed the final task is to determine the water quality limits for each observation using the <code><a href="../reference/calc_limits.html">calc_limits()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">data2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_limits.html">calc_limits</a></span>(<span class="kw">data2012</span>, by = <span class="st">"SiteID"</span>, term = <span class="st">"short"</span>)
<span class="co">#&gt; Cleaning water quality data...</span>
<span class="co">#&gt; Identified 0 outliers in water quality data.</span>
<span class="co">#&gt; Cleansed water quality data.</span>
<span class="co">#&gt; Standardizing water quality data...</span>
<span class="co">#&gt; Standardized water quality data.</span>
<span class="co">#&gt; Calculating short-term water quality limits...</span>
<span class="co">#&gt; Dropped 147 values for Alkalinity Total without limits</span>
<span class="co">#&gt; Dropped 142 values for Ammonia Dissolved without limits</span>
<span class="co">#&gt; Dropped 34 values for Arsenic Dissolved without limits</span>
<span class="co">#&gt; Dropped 34 values for Barium Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Barium Total without limits</span>
<span class="co">#&gt; Dropped 279 values for Beryllium Total without limits</span>
<span class="co">#&gt; Dropped 34 values for Boron Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Boron Total without limits</span>
<span class="co">#&gt; Dropped 1 values for Cadmium Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Cadmium Total without limits</span>
<span class="co">#&gt; Dropped 34 values for Chromium Dissolved without limits</span>
<span class="co">#&gt; Dropped 278 values for Chromium Total without limits</span>
<span class="co">#&gt; Dropped 34 values for Cobalt Dissolved without limits</span>
<span class="co">#&gt; Dropped 1 values for Copper Dissolved without limits</span>
<span class="co">#&gt; Dropped 278 values for Copper Total without limits</span>
<span class="co">#&gt; Dropped 162 values for Fluoride Dissolved without limits</span>
<span class="co">#&gt; Dropped 284 values for Hardness Total without limits</span>
<span class="co">#&gt; Dropped 33 values for Lead Dissolved without limits</span>
<span class="co">#&gt; Dropped 34 values for Manganese Dissolved without limits</span>
<span class="co">#&gt; Dropped 34 values for Molybdenum Dissolved without limits</span>
<span class="co">#&gt; Dropped 34 values for Nickel Dissolved without limits</span>
<span class="co">#&gt; Dropped 278 values for Nickel Total without limits</span>
<span class="co">#&gt; Dropped 284 values for Nitrogen Dissolved without limits</span>
<span class="co">#&gt; Dropped 284 values for Nitrogen Total without limits</span>
<span class="co">#&gt; Dropped 192 values for Oxygen Dissolved without limits</span>
<span class="co">#&gt; Dropped 284 values for pH without limits</span>
<span class="co">#&gt; Dropped 281 values for Phosphorus Dissolved without limits</span>
<span class="co">#&gt; Dropped 264 values for Phosphorus Total without limits</span>
<span class="co">#&gt; Dropped 34 values for Selenium Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Selenium Total without limits</span>
<span class="co">#&gt; Dropped 33 values for Silver Dissolved without limits</span>
<span class="co">#&gt; Dropped 199 values for Sulphate Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Temperature without limits</span>
<span class="co">#&gt; Dropped 34 values for Thallium Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Thallium Total without limits</span>
<span class="co">#&gt; Dropped 284 values for Turbidity without limits</span>
<span class="co">#&gt; Dropped 34 values for Uranium Dissolved without limits</span>
<span class="co">#&gt; Dropped 279 values for Uranium Total without limits</span>
<span class="co">#&gt; Dropped 33 values for Zinc Dissolved without limits</span>
<span class="co">#&gt; Calculated short-term water quality limits.</span>
</pre></div>
<p>The final result is a data frame with 2602 rows each of which has an upper water quality limit.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">data2012</span>)
<span class="co">#&gt; # A tibble: 2,602 x 8</span>
<span class="co">#&gt;    SiteID  Date       Variable     Value UpperLimit Units Outlier DetectionLimit</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;lgl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 BC08KA… 2012-01-24 Arsenic T… 0.12          5    ug/L  NA                  NA</span>
<span class="co">#&gt;  2 BC08KA… 2012-01-24 Chloride … 0           600    mg/L  NA                  NA</span>
<span class="co">#&gt;  3 BC08KA… 2012-01-24 Cobalt To… 0.2         110    ug/L  NA                  NA</span>
<span class="co">#&gt;  4 BC08KA… 2012-01-24 Iron Total 0.0303        1    mg/L  NA                  NA</span>
<span class="co">#&gt;  5 BC08KA… 2012-01-24 Lead Total 0.01         61.2  ug/L  NA                  NA</span>
<span class="co">#&gt;  6 BC08KA… 2012-01-24 Manganese… 0.0112        1.42 mg/L  NA                  NA</span>
<span class="co">#&gt;  7 BC08KA… 2012-01-24 Molybdenu… 0.00007       2    mg/L  NA                  NA</span>
<span class="co">#&gt;  8 BC08KA… 2012-01-24 Silver To… 0             0.1  ug/L  NA                  NA</span>
<span class="co">#&gt;  9 BC08KA… 2012-01-24 Zinc Total 0.3          33    ug/L  NA                  NA</span>
<span class="co">#&gt; 10 BC08KA… 2012-04-11 Arsenic T… 0.1           5    ug/L  NA                  NA</span>
<span class="co">#&gt; # … with 2,592 more rows</span>
</pre></div>
</div>
<div id="calculating-water-quality-index" class="section level3">
<h3 class="hasAnchor">
<a href="#calculating-water-quality-index" class="anchor"></a>Calculating Water Quality Index</h3>
<p>The resultant data can be used to calculate water quality indices using the <code>calc_wqi()</code> function of the <code>wqindex</code> package.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joe Thorley, Colin Millar, Andy Teucher.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
